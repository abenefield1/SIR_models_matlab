%Initial Conditions:
S_0 = 1000;
I_0_0=25;
I_k_0=0;
I_n_0=0;
T1 = 0:20;

N=1025;
beta= 0.56; % Rate of infection
gamma=0.2;
mu=0.005;
n=10

for k = [0:1:n]
    [t, state]=ode45(@(t, state) test1(t, state, N, beta, gamma, mu), T1, [S_0 I_0_0 I_k_0 I_n_0]);
    S=state(:,1);
    I_0=state(:,2);
    I_k=state(:,3);
    I_n=state(:,4);

    loyolagreen = 1/255*[50,205,50];
    %orange = 1/255*[255,127,36];
    orange = 1/255*[238,173,14];
    %subplot(2,2,i)
    plot(t,S,'Color', loyolagreen,'LineWidth',2); hold on
    plot(t,I_0,'m','LineWidth',3); hold on
    plot(t,I_k,'r','Linewidth',2); hold on
    plot(t,I_n,'b','LineWidth',2);
    xlabel('Days')
    ylabel('Disease Incidence')
    h=legend('S', 'I_0','I_k','I_n','Location','northeast');
    %end

    function f=test1 (t, state, N, beta, gamma, mu);
        S=state(1);
        I_0=state(2);
        I_k=state(3);
        I_n=state(4);

        f(1,1)=-beta*S*(I_0+I_k+I_n); % Susceptible, S
        f(2,1)=beta*S*I_0-(gamma+mu)*I_0; % Infected strain 0, I_0
        f(3,1)= beta*S*I_k-(gamma+mu)*I_k+mu*I_0; % Infected strain K, I_k
        f(4,1)= beta*S*I_n-gamma*I_n+mu*I_k; % Infected strain n, I_n

    end
end